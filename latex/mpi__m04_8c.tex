\hypertarget{mpi__m04_8c}{\section{src/mpi\-\_\-m04.c File Reference}
\label{mpi__m04_8c}\index{src/mpi\-\_\-m04.\-c@{src/mpi\-\_\-m04.\-c}}
}


Laboratorio M4.  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$mpi.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include \char`\"{}utils.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{mpi__m04_8c_a5c32c8bd846ce1ebad44c1a1809fc067}{mod} (int D, int d)
\item 
void \hyperlink{mpi__m04_8c_a22ada4653ee0481392e90cfd09bf2343}{envio} (int dest, int secc\-\_\-env)
\item 
void \hyperlink{mpi__m04_8c_a310eb3f2aaa9356ca09b027c0c5f88ff}{recepcion} (int orig, int secc\-\_\-env)
\item 
int \hyperlink{mpi__m04_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{mpi__m04_8c_a2f852d57f5c63ebea3f007e3360806c4}{mi\-\_\-id}
\item 
int \hyperlink{mpi__m04_8c_ab00de16e9393bbf005012413043ea74d}{num\-\_\-procs}
\item 
int \hyperlink{mpi__m04_8c_aadf75c541436fefd71b2cba8d25a75fe}{etapas}
\item 
int $\ast$ \hyperlink{mpi__m04_8c_ae086787f574c1a13b95728ca3cddbc08}{vector}
\item 
int \hyperlink{mpi__m04_8c_a62359957ca77ebf4d9d28cd0b99b901f}{M\-U\-L\-T\-I\-P\-L\-O} = 1
\item 
M\-P\-I\-\_\-\-Status \hyperlink{mpi__m04_8c_acd880fccdcf85d7453df9e53e49283d2}{st}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Laboratorio M4. \subsection*{Recogida global en M\-P\-I (I\-I\-I)}

Desarrolla una implementación eficiente de {\itshape recogida global} en M\-P\-I que utilice un esquema de {\bfseries concatenación}. El procedimiento se desarrolla en {\itshape p} etapas. En cada etapa un proceso envía una parte del vector a su vecino de la derecha y recibe otra parte de su vecino de la izquierda. En la primera etapa la parte enviada es la propia. En cada una de las siguientes {\itshape p − 1} etapas, la parte enviada es la recibida en la etapa anterior. 

\subsection{Function Documentation}
\hypertarget{mpi__m04_8c_a22ada4653ee0481392e90cfd09bf2343}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!envio@{envio}}
\index{envio@{envio}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{envio}]{\setlength{\rightskip}{0pt plus 5cm}void envio (
\begin{DoxyParamCaption}
\item[{int}]{dest, }
\item[{int}]{secc\-\_\-env}
\end{DoxyParamCaption}
)}}\label{mpi__m04_8c_a22ada4653ee0481392e90cfd09bf2343}
Realizar un envío a un proceso 
\begin{DoxyParams}{Parameters}
{\em dest} & El id del proceso destino \\
\hline
{\em secc\-\_\-env} & El segmento del vector \\
\hline
\end{DoxyParams}
\hypertarget{mpi__m04_8c_a3c04138a5bfe5d72780bb7e82a18e627}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!main@{main}}
\index{main@{main}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}}\label{mpi__m04_8c_a3c04138a5bfe5d72780bb7e82a18e627}
Función main. Inicializa M\-P\-I y ejecuta el algoritmo de {\bfseries concatenación}.


\begin{DoxyParams}{Parameters}
{\em argc} & parámetro automático con el número de argumentos recibidos desde el C\-L\-I \\
\hline
{\em argv} & {\ttfamily \mbox{[}1\mbox{]}} el primer parámetro del C\-L\-I especifica el número de elementos del vector que pertenecen a cada proceso ({\ttfamily M\-U\-L\-T\-I\-P\-L\-O}). Por defecto {\ttfamily M\-U\-L\-T\-I\-P\-L\-O} es 1. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si todo ha ido bien. 
\end{DoxyReturn}
Inicializa el vector\-:


\begin{DoxyItemize}
\item Cada proceso tiene su identificador como valores de su tramo del vector y el resto de valores serán 0.
\end{DoxyItemize}

Cada proceso imprime su vector.

Se inicializan las variables de control de comunicaciones.

Comienza el bucle con tantas etapas como procesos\-:


\begin{DoxyItemize}
\item Se decide quién es el proceso desde el cual vamos a recibir datos y cuál será el proceso al cual enviaremos datos con la siguiente fórmula\-:

$p_{origen} = (i - 1) \mod n$ $p_{destino} = (i + 1) \mod n$ \begin{DoxyVerb}     siendo _i_ el número del proceso actual, y _n_ el número de procesos.\end{DoxyVerb}

\end{DoxyItemize}


\begin{DoxyItemize}
\item Se decide la sección del vector que se va a enviar y la que se va a recibir, mediante la siguiente fórmula\-:

$s_{envío} = (i - e) \mod n$ $s_{recepción} = (i - e - 1) \mod n$ siendo {\itshape i} el número del proceso actual, {\itshape e} la etapa actual y {\itshape n} el número de procesos.
\end{DoxyItemize}


\begin{DoxyItemize}
\item Se decide si el proceso {\bfseries envía} primero y {\bfseries recibe} después o alrevés en función de si el identificador del proceso es par o impar, y se realiza el envío.

Los procesos pares envían primero y los impares reciben primero.
\end{DoxyItemize}


\begin{DoxyItemize}
\item Cada proceso muestra su vector, con los elementos ya compartidos.
\end{DoxyItemize}


\begin{DoxyItemize}
\item Finaliza M\-P\-I y retorna el valor 0. 
\end{DoxyItemize}\hypertarget{mpi__m04_8c_a5c32c8bd846ce1ebad44c1a1809fc067}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!mod@{mod}}
\index{mod@{mod}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{mod}]{\setlength{\rightskip}{0pt plus 5cm}int mod (
\begin{DoxyParamCaption}
\item[{int}]{D, }
\item[{int}]{d}
\end{DoxyParamCaption}
)}}\label{mpi__m04_8c_a5c32c8bd846ce1ebad44c1a1809fc067}
Implementación del operador {\ttfamily \%} teniendo en cuenta módulos negativos


\begin{DoxyParams}{Parameters}
{\em D} & Dividendo \\
\hline
{\em d} & Divisor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
$D \mod d$, teniendo en cuenta el signo de {\itshape D}. Por ejemplo, {\ttfamily mod(-\/1, 8)} devolverá {\ttfamily 7} 
\end{DoxyReturn}
\hypertarget{mpi__m04_8c_a310eb3f2aaa9356ca09b027c0c5f88ff}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!recepcion@{recepcion}}
\index{recepcion@{recepcion}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{recepcion}]{\setlength{\rightskip}{0pt plus 5cm}void recepcion (
\begin{DoxyParamCaption}
\item[{int}]{orig, }
\item[{int}]{secc\-\_\-env}
\end{DoxyParamCaption}
)}}\label{mpi__m04_8c_a310eb3f2aaa9356ca09b027c0c5f88ff}
Realizar una recepción desde un proceso 
\begin{DoxyParams}{Parameters}
{\em orig} & El id del proceso origen \\
\hline
{\em secc\-\_\-env} & El segmento del vector \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\hypertarget{mpi__m04_8c_aadf75c541436fefd71b2cba8d25a75fe}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!etapas@{etapas}}
\index{etapas@{etapas}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{etapas}]{\setlength{\rightskip}{0pt plus 5cm}int etapas}}\label{mpi__m04_8c_aadf75c541436fefd71b2cba8d25a75fe}
Número de etapas de la compartición de elementos. Se calcula como $N$, siendo {\itshape N} el número de procesos. \hypertarget{mpi__m04_8c_a2f852d57f5c63ebea3f007e3360806c4}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!mi\-\_\-id@{mi\-\_\-id}}
\index{mi\-\_\-id@{mi\-\_\-id}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{mi\-\_\-id}]{\setlength{\rightskip}{0pt plus 5cm}int mi\-\_\-id}}\label{mpi__m04_8c_a2f852d57f5c63ebea3f007e3360806c4}
Número que identifica a cada proceso. Es asignado automáticamente por M\-P\-I al ejecutar con mpirun. \hypertarget{mpi__m04_8c_a62359957ca77ebf4d9d28cd0b99b901f}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!M\-U\-L\-T\-I\-P\-L\-O@{M\-U\-L\-T\-I\-P\-L\-O}}
\index{M\-U\-L\-T\-I\-P\-L\-O@{M\-U\-L\-T\-I\-P\-L\-O}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{M\-U\-L\-T\-I\-P\-L\-O}]{\setlength{\rightskip}{0pt plus 5cm}int M\-U\-L\-T\-I\-P\-L\-O = 1}}\label{mpi__m04_8c_a62359957ca77ebf4d9d28cd0b99b901f}
Número de elementos del vector que posee cada proceso. Este parámetro puede cambiarse especificando otro valor como primer parámetro desde la línea de comandos \hypertarget{mpi__m04_8c_ab00de16e9393bbf005012413043ea74d}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!num\-\_\-procs@{num\-\_\-procs}}
\index{num\-\_\-procs@{num\-\_\-procs}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{num\-\_\-procs}]{\setlength{\rightskip}{0pt plus 5cm}int num\-\_\-procs}}\label{mpi__m04_8c_ab00de16e9393bbf005012413043ea74d}
Número de procesos. Es establecido automáticamente por M\-P\-I al ejecutar con mpirun. \hypertarget{mpi__m04_8c_acd880fccdcf85d7453df9e53e49283d2}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!st@{st}}
\index{st@{st}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{st}]{\setlength{\rightskip}{0pt plus 5cm}M\-P\-I\-\_\-\-Status st}}\label{mpi__m04_8c_acd880fccdcf85d7453df9e53e49283d2}
\hypertarget{mpi__m04_8c_ae086787f574c1a13b95728ca3cddbc08}{\index{mpi\-\_\-m04.\-c@{mpi\-\_\-m04.\-c}!vector@{vector}}
\index{vector@{vector}!mpi_m04.c@{mpi\-\_\-m04.\-c}}
\subsubsection[{vector}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ vector}}\label{mpi__m04_8c_ae086787f574c1a13b95728ca3cddbc08}
Vector con los valores a repartir entre procesos. 